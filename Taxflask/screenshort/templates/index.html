<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Loader</title>
</head>
<body>
    <div>
        <input type="text" id="urlInput" placeholder="Enter URL here...">
        <button onclick="loadUrl()">Load</button>
        <button onclick="takeScreenshot()">Take Screenshot</button>
    </div>
    <iframe id="websiteLoader" style="width: 100%; height: 600px;"></iframe>
    <div id="screenshotDiv"></div> <!-- This div will contain the screenshot -->
    <script>
        function loadUrl() {
            const urlInput = document.getElementById('urlInput');
            const websiteLoader = document.getElementById('websiteLoader');
            fetch('/load_url', {
                method: 'POST',
                body: new URLSearchParams({
                    'url': urlInput.value
                }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(response => response.text())
            .then(data => {
                websiteLoader.srcdoc = data; // Use srcdoc to display HTML content in the iframe
            })
            .catch(error => console.error('Error:', error));
        }

        function takeScreenshot() {
            const websiteLoader = document.getElementById('websiteLoader');
            const htmlContent = websiteLoader.srcdoc;
            
            fetch('/take_screenshot', {
                method: 'POST',
                body: new URLSearchParams({
                    'html_content': htmlContent
                }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(response => response.json())
            .then(data => {
                displayScreenshot(data.screenshot);
            })
            .catch(error => console.error('Error:', error));
        }

        function displayScreenshot(screenshot) {
            const image = new Image();
            image.src = 'data:image/png;base64,' + screenshot;

            // Display the image in the div with id 'screenshotDiv'
            const screenshotDiv = document.getElementById('screenshotDiv');
            screenshotDiv.innerHTML = ''; // Clear previous images
            screenshotDiv.appendChild(image);
        }
    </script>
</body>
</html>
